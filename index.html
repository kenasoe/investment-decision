<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>配当利回り管理</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background-color: #f9f9f9; }
    h1 { text-align: center; }
    #summary-hdv { font-size: 1.2em; margin-bottom: 20px; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #eee; }
    .future-val { font-weight: bold; color: #0056b3; }
    input[type="number"] { width: 80px; text-align: right; }
    @media (max-width: 480px) {
      body { font-size: 16px; }
      h1 { font-size: 1.6em; }
      h2 { font-size: 1.3em; margin-top: 30px; }
      th, td { font-size: 14px; padding: 6px 4px; white-space: nowrap; }
      input[type="number"] { width: 60px; }
    }
  </style>
</head>
<body>
  <h1>Make 810 yen a day</h1>

  <h2>日本株405円</h2>
  <table>
    <thead>
      <tr>
        <th>銘柄名</th>
        <th>配当金（円）</th>
        <th>目標利回り（%）</th>
        <th>株価（円）</th>
        <th>利回り（%）</th>
        <th>2034利回（%）</th>
      </tr>
    </thead>
    <tbody id="stock-table-japan"></tbody>
  </table>

  <h2>日本高配当ETF</h2>
  <table>
    <thead>
      <tr>
        <th>銘柄名</th>
        <th>配当金（円）</th>
        <th>基準価格（円）</th>
        <th>利回り（%）</th>
        <th>投資額（円）</th>
      </tr>
    </thead>
    <tbody id="stock-table-reit"></tbody>
  </table>

  <h2>米国高配当株 (VYM, SPYD, SCHD)</h2>
  <table>
    <thead>
      <tr>
        <th>銘柄名</th>
        <th>配当金（円）</th>
        <th>基準価格（円）</th>
        <th>利回り（%）</th>
        <th>投資額（円）</th>
      </tr>
    </thead>
    <tbody id="stock-table-us"></tbody>
  </table>

  <h2>HDV</h2>
  <div id="summary-hdv">合計配当金: 0 円 / 合計株数: 0 株</div>
  <button onclick="resetQuantities('hdv')">株数リセット</button>
  <table>
    <thead>
      <tr>
        <th>銘柄名</th>
        <th>配当金（円）</th>
        <th>株価（円）</th>
        <th>株数</th>
        <th>利回り（%）</th>
      </tr>
    </thead>
    <tbody id="stock-table-hdv"></tbody>
  </table>

  <div id="memoModal" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:#fff; padding:20px; border:1px solid #ccc; box-shadow:0 0 10px rgba(0,0,0,0.3); z-index:9999; max-width: 90%;">
    <div id="memoContent" style="margin-bottom:10px;"></div>
    <button onclick="closeMemo()">閉じる</button>
  </div>
  <div id="modalOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); z-index:9998;" onclick="closeMemo()"></div>

  <script>
    // futureMultiplier: 2034年想定利回りを計算するための係数（指定がなければ1.0）
    const japanStocks = [
      { name: 'JT(5106)', dividend: 234, targetYield: 4.5, price: 5730, memo: '過去は4000円未満で買っている JCR:AA+ R&I:AA 訴訟リスク内包しつつも高格付 理論5106', futureMultiplier: 1.3 },
      { name: '積水ハウス(4591)', dividend: 144, targetYield: 4.6, price: 3480, memo: '減配可能性低い JCR:AA R&I:AA 理論4591', futureMultiplier: 1.4 },
      { name: '第一生命', dividend: 51, targetYield: 4.0, price: 1360, memo: '国内成熟 海外成長 コア補完銘柄', futureMultiplier: 1.3 },
      { name: '野村不動産', dividend: 36, targetYield: 4.0, price: 1003, memo: '配当無理のない水準、DOE導入 理論1284', futureMultiplier: 1.5 },
      { name: '東京海上(4654)', dividend: 211, targetYield: 3.5, price: 5905, memo: 'JCR:AAA 理論4654', futureMultiplier: 1.6 },
      { name: 'NTT(229)', dividend: 5.3, targetYield: 3.5, price: 157, memo: '安定増配×1.6 JCR:AAA 理論229', futureMultiplier: 1.6 },
      { name: '大和ハウス(4万)', dividend: 175, targetYield: 3.5, price: 5286, memo: 'JCR:AA R&I:AA- 理論5959', futureMultiplier: 1.3 },
      { name: 'INPEX(5118)', dividend: 100, targetYield: 4.5, price: 3048, memo: '増配×1.8 PBR0.5台→割安 JCR:AA+ R&I:AA 理論5118', futureMultiplier: 1.8 },
      { name: 'アサヒ', dividend: 52, targetYield: 3.5, price: 1646, memo: 'JCR:AA- R&I:A+ 理論2650', futureMultiplier: 1.5 },
      { name: 'キリン', dividend: 74, targetYield: 3.5, price: 2345, memo: 'R&I:A+ 理論3209', futureMultiplier: 1.5 },
      { name: '三菱商事(3211)', dividend: 110, targetYield: 3.6, price: 3739, memo: 'R&I:AA 理論3211', futureMultiplier: 1.4 },
      { name: 'ENEOS(1460)', dividend: 34, targetYield: 4.5, price: 1161, memo: '増配×1.1 ガソリン代の一部に JCR:AA- R&I:A+ 理論1460', futureMultiplier: 1.1 },
      { name: '明治(4447)', dividend: 105, targetYield: 3, price: 3518, memo: '〇', futureMultiplier: 1.4 },
      { name: '三菱UFJ(〇)', dividend: 74, targetYield: 3.5, price: 2545, memo: '理論〇', futureMultiplier: 1.0 },
      { name: 'トヨタ(3505)', dividend: 95, targetYield: 3.5, price: 3294, memo: 'JCR:AAA R&I:AAA 理論3505', futureMultiplier: 1.8 },
      { name: '伊藤忠(10万)', dividend: 42, targetYield: 3.5, price: 1985, memo: '理論1338', futureMultiplier: 1.5 },
      { name: '王子HD(1314)→×増えず', dividend: 36, targetYield: 4.0, price: 894, memo: '海外4割 成熟企業 配当無理のない水準 JCR:AA- R&I:A+ 理論1314', futureMultiplier: 1.1 },
      { name: '野村HD→×', dividend: 57, targetYield: 4.0, price: 1291, memo: '配当増減、景気敏感株 JCR:AA- R&I:A 理論1597', futureMultiplier: 1.0 },
      { name: 'LIXIL(2272)→×', dividend: 90, targetYield: 5.0, price: 1898, memo: '利益超の配当、低利益 JCR:A+ R&I:A 理論2272', futureMultiplier: 1.0 },
      { name: '電通(11万)→×', dividend: 0, targetYield: 4.5, price: 3469, memo: '安定増配×1.5 R&I:AA- 理論1470', futureMultiplier: 1.5 }
    ];

    const usStocks = [
      { name: 'VYM', dividend: 310, basePrice: 12186, memo: '今の高配当銘柄400銘柄 87円', targetIncomePerDay: 87 },
      { name: 'SPYD', dividend: 425, basePrice: 11848, memo: 'SP500から80銘柄 配当中心、リスク高め 87円', targetIncomePerDay: 87 },
      { name: 'SCHD', dividend: 310, basePrice: 10304, memo: '10年以上の増配企業 100銘柄 174円', targetIncomePerDay: 174 }
    ];

    const reitStocks = [
      { name: 'ETF1489', dividend: 89, basePrice: 2851, memo: '50/日経225 コスト0.37', targetIncomePerDay: 202.5 },
      { name: 'SBI日本高配当', dividend: 510, basePrice: 14819, memo: '中型株へも投資 コスト0.1', targetIncomePerDay: 202.5 }
    ];

    const hdvStocks = [ { name: 'HDV', dividend: 5.7, price: 237.7, memo: '75銘柄 安全志向', quantity: 0 } ];

    function renderTable(stockList, tableId, summaryId) {
      const table = document.getElementById(tableId);
      if (!table) return;
      
      table.innerHTML = '';
      let totalDividend = 0, totalQuantity = 0;

      stockList.forEach((stock, i) => {
        stock.quantity = stock.quantity || 0;
        let yieldCalc = '0.00', investAmount = '-';

        // 利回り計算
        if (tableId === 'stock-table-us' || tableId === 'stock-table-reit') {
          // 米国・日本ETF
          yieldCalc = stock.basePrice ? (stock.dividend / stock.basePrice * 100).toFixed(2) : '0.00';
          const val = stock.basePrice ? stock.dividend / stock.basePrice : 0;
          investAmount = val > 0 ? Math.round(((stock.targetIncomePerDay || 87) / val) / 100) * 100 : '-';
        } else {
          // 日本株・HDV
          yieldCalc = stock.price ? (stock.dividend / stock.price * 100).toFixed(2) : '0.00';
        }

        const nameCell = `<span style="cursor:pointer;text-decoration:underline;" onclick="showMemo('${stock.memo || ''}')">${stock.name}</span>`;
        const tr = document.createElement('tr');

        // テーブルごとの表示生成
        if (tableId === 'stock-table-us' || tableId === 'stock-table-reit') {
          // 米国株・ETF
          tr.innerHTML = `<td>${nameCell}</td><td>${stock.dividend}</td><td><input type="number" min="0" value="${stock.basePrice}" onchange="updateBasePrice('${tableId}',null,${i},this.value)"></td><td>${yieldCalc}</td><td>${investAmount}</td>`;
        
        } else if (tableId === 'stock-table-hdv') {
          // HDV
          tr.innerHTML = `<td>${nameCell}</td><td>${stock.dividend}</td><td><input type="number" min="1" value="${stock.price}" onchange="updatePrice('${tableId}','summary-hdv',${i},this.value)"></td><td><input type="number" min="0" value="${stock.quantity}" onchange="updateQuantity('${tableId}','summary-hdv',${i},this.value)"></td><td>${yieldCalc}</td>`;
        
        } else {
          // 日本株（ここを修正：判定 → 2034利回）
          const multiplier = stock.futureMultiplier || 1.0;
          const futureYield = (parseFloat(yieldCalc) * multiplier).toFixed(2);
          
          tr.innerHTML = `<td>${nameCell}</td>
                          <td>${stock.dividend}</td>
                          <td>${stock.targetYield}</td>
                          <td><input type="number" min="1" value="${stock.price}" onchange="updatePrice('${tableId}','',${i},this.value)"></td>
                          <td>${yieldCalc}</td>
                          <td class="future-val">${futureYield}</td>`;
        }

        table.appendChild(tr);

        if (stock.quantity) {
          totalDividend += stock.dividend * stock.quantity;
          totalQuantity += stock.quantity;
        }
      });

      // 合計表示
      if (summaryId) {
        const summaryEl = document.getElementById(summaryId);
        if (summaryEl) {
           summaryEl.innerText = `合計配当金: ${totalDividend.toLocaleString()} 円 / 合計株数: ${totalQuantity.toLocaleString()} 株`;
        }
      }
    }

    // データ更新用の関数群
    function updateQuantity(tid, sid, i, val) {
      getListById(tid)[i].quantity = parseInt(val) || 0;
      renderTable(getListById(tid), tid, sid);
    }
    function updatePrice(tid, sid, i, val) {
      getListById(tid)[i].price = parseFloat(val) || 0;
      renderTable(getListById(tid), tid, sid === '' ? null : sid);
    }
    function updateBasePrice(tid, sid, i, val) {
      getListById(tid)[i].basePrice = parseFloat(val) || 0;
      renderTable(getListById(tid), tid, sid === '' ? null : sid);
    }

    function resetQuantities(type) {
      const list = (type === 'japan' ? japanStocks : type === 'us' ? usStocks : type === 'reit' ? reitStocks : hdvStocks);
      list.forEach(s => { if ('quantity' in s) s.quantity = 0; });
      
      const ids = { japan: 'stock-table-japan', us: 'stock-table-us', reit: 'stock-table-reit', hdv: 'stock-table-hdv' };
      const sids = { japan: null, hdv: 'summary-hdv' }; 
      
      renderTable(list, ids[type], sids[type] || null);
    }

    function getListById(tid) {
      if (tid === 'stock-table-japan') return japanStocks;
      if (tid === 'stock-table-us') return usStocks;
      if (tid === 'stock-table-reit') return reitStocks;
      return hdvStocks;
    }

    function showMemo(text) {
      document.getElementById('memoContent').innerText = text || '（メモは登録されていません）';
      document.getElementById('memoModal').style.display = 'block';
      document.getElementById('modalOverlay').style.display = 'block';
    }
    function closeMemo() {
      document.getElementById('memoModal').style.display = 'none';
      document.getElementById('modalOverlay').style.display = 'none';
    }

    // 初期描画実行
    renderTable(japanStocks, 'stock-table-japan', null);
    renderTable(reitStocks, 'stock-table-reit', null);
    renderTable(usStocks, 'stock-table-us', null);
    renderTable(hdvStocks, 'stock-table-hdv', 'summary-hdv');
  </script>

  <div style="text-align:center; margin-top: 40px;">
    <a href="https://finance.yahoo.co.jp/quote/89311241" target="_blank">VYM</a> |
    <a href="https://finance.yahoo.co.jp/quote/89312241" target="_blank">SPYD</a> |
    <a href="https://finance.yahoo.co.jp/quote/8931224C" target="_blank">SCHD</a> |
    <a href="https://finance.yahoo.co.jp/quote/8931123C" target="_blank">SBI高配当</a>
  </div>
</body>
</html>
